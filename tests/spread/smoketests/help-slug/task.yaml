summary: verify the docs link is being shown

systems:
  - ubuntu-22.04-64

prepare: |
  charmcraft init --project-dir=charm

  # change requirements to be invalid
  sed -e 's/"ops/"this-is-not-a-valid-replacement-for-ops/' -i charm/pyproject.toml
  rm charm/uv.lock

restore: |
  pushd charm
  charmcraft clean
  popd

  rm -rf charm

execute: |
  charmcraft help |& MATCH 'For more information about charmcraft, check out: https://documentation.ubuntu.com/charmcraft/latest'

  cd charm

  charmcraft build |& MATCH 'For more information, check out: https://documentation.ubuntu.com/charmcraft/latest/reference/plugins'
